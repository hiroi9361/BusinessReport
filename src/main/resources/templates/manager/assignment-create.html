<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org"
      xmlns:layout="http://www.ultraq.net.nz/web/thymeleaf/layout"
      layout:decorate="~{layout/layout}">
<head>
    <meta charset="UTF-8" th:remove="tag">
</head>
<body>
<div layout:fragment="content">
    <div class="container mt-3">
    <h1 class="text-center">メンバー編集</h1>
    <h1 th:text="${team.name}" class="text-center"></h1>
    <div class="container-form">
        <form th:action="@{/manager/assignment/create}" th:object="${assignmentCreateInput}" method="post">
            <input type="hidden" name="teamId" th:value="${team.teamId}"/>
            <label>Manager</label>
            <div class="form-group mb-3 d-flex">
                <select id="managerList" class="form-select" name="employeeCode" multiple>
                    <option th:each="manager : ${managers}" th:text="${manager.name}" th:value="${manager.employeeCode}"></option>
                </select>
                <div>
                    <button type="button" onclick="addManager()" class="btn btn-success">←追加</button>
                    <button type="button" onclick="removeManager()" class="btn btn-success">→削除</button>
                </div>
                <select id="userList" class="form-select" multiple>
                    <option th:each="user : ${users}" th:text="${user.name}" th:value="${user.employeeCode}"></option>
                </select>
            </div>
            <label>Member</label>
            <div class="form-group mb-3 d-flex">
                <select id="memberList" class="form-select" name="employeeCode" multiple>
                    <option th:each="member : ${members}" th:text="${member.name}" th:value="${member.employeeCode}"></option>
                </select>
                <div>
                    <button type="button" onclick="addMember()" class="btn btn-success">←追加</button>
                    <button type="button" onclick="removeMember()" class="btn btn-success">→削除</button>
                </div>
                <select id="usersList" class="form-select" multiple>
                    <option th:each="user : ${users}" th:text="${user.name}" th:value="${user.employeeCode}"></option>
                </select>
            </div>
            <div class="form-group mb-3">
                <button type="submit" class="w-100 btn btn-lg btn-success">追加</button>
            </div>
        </form>
    </div>
        <div class="button-box">
    <a th:href=@{/manager/teamlist}>チーム一覧ページに戻る</a>
        </div>
    </div>
</div>
<script layout:fragment="script">
    function addManager() {
        var userSelect = document.getElementById("userList");
        var managerList = document.getElementById("managerList");

        // Loop through all selected options
        for (var i = 0; i < userSelect.selectedOptions.length; i++) {
            var userOption = userSelect.selectedOptions[i];

            // Create a new option element for the managerList
            var managerAdd = document.createElement("option");
            managerAdd.text = userOption.text;
            managerAdd.value = userOption.value;

            // Add the new option to the managerList
            managerList.add(managerAdd);
        }
    }
    function removeManager() {
        var managerList = document.getElementById("managerList");
        var selectedIndexes = [];
        // Get the selected indexes in reverse order
        for (var i = managerList.options.length - 1; i >= 0; i--) {
            if (managerList.options[i].selected) {
                selectedIndexes.push(i);
            }
        }
        // Remove the selected options
        selectedIndexes.forEach(function (index) {
            managerList.remove(index);
        });
    }

    function addMember() {
        var userSelect = document.getElementById("usersList");
        var memberList = document.getElementById("memberList");

        // Loop through all selected options
        for (var i = 0; i < userSelect.selectedOptions.length; i++) {
            var userOption = userSelect.selectedOptions[i];

            // Create a new option element for the memberList
            var memberAdd = document.createElement("option");
            memberAdd.text = userOption.text;
            memberAdd.value = userOption.value;

            // Add the new option to the memberList
            memberList.add(memberAdd);
        }
    }
    function removeMember() {
        var memberList = document.getElementById("memberList");
        var selectedIndexes = [];
        // Get the selected indexes in reverse order
        for (var i = memberList.options.length - 1; i >= 0; i--) {
            if (memberList.options[i].selected) {
                selectedIndexes.push(i);
            }
        }
        // Remove the selected options
        selectedIndexes.forEach(function (index) {
            memberList.remove(index);
        });
    }
</script>
</body>
</html>